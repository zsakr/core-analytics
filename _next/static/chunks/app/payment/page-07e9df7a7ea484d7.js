(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8407],{779:(e,t,r)=>{Promise.resolve().then(r.bind(r,6130))},3999:(e,t,r)=>{"use strict";r.d(t,{cn:()=>n});var a=r(2596),s=r(9688);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.QP)((0,a.$)(t))}},4861:(e,t,r)=>{"use strict";r.d(t,{A:()=>c,AuthProvider:()=>o});var a=r(5155),s=r(2115),n=r(6203),i=r(8915);let l=(0,s.createContext)({user:null,isLoading:!0,signOut:async()=>{},error:null}),c=()=>(0,s.useContext)(l);function o(e){let{children:t}=e,[r,c]=(0,s.useState)(null),[o,d]=(0,s.useState)(!0),[u,m]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=(0,n.hg)(i.j2,e=>{c(e),d(!1)},e=>{m(e.message),d(!1)});return()=>e()},[]);let p=async()=>{try{await (0,n.CI)(i.j2)}catch(e){m(e.message)}};return(0,a.jsx)(l.Provider,{value:{user:r,isLoading:o,signOut:p,error:u},children:t})}},6130:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>T});var a=r(5155),s=r(2115),n=r(5695),i=r(6874),l=r.n(i),c=r(2919),o=r(7550),d=r(646),u=r(7168),m=r(8482);let p=0,h=new Map,f=e=>{if(h.has(e))return;let t=setTimeout(()=>{h.delete(e),v({type:"REMOVE_TOAST",toastId:e})},1e6);h.set(e,t)},x=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?f(r):e.toasts.forEach(e=>{f(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},y=[],g={toasts:[]};function v(e){g=x(g,e),y.forEach(e=>{e(g)})}function b(e){let{...t}=e,r=(p=(p+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>v({type:"DISMISS_TOAST",toastId:r});return v({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||a()}}}),{id:r,dismiss:a,update:e=>v({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function j(){let[e,t]=s.useState(g);return s.useEffect(()=>(y.push(t),()=>{let e=y.indexOf(t);e>-1&&y.splice(e,1)}),[e]),{...e,toast:b,dismiss:e=>v({type:"DISMISS_TOAST",toastId:e})}}var w=r(4861),N=r(7368),S=r(5855);let C=(0,N.c)("pk_test_51R6jHwK9Ur9Sau8fQAH2Ff4mD9DG7RlaqSlgh9sNcN6alF9l2J7yydEf7XwaMezBcks8IQg5Wcl3rrYKrOX1hNQs00jilEssPm"),k={"core-beta":{name:"Core Beta",type:"Individual",price:14.99,billingCycle:"monthly",features:["6 uploads per month","One Time 3 credits included","Basic match analysis","Core Connect"]},performance:{name:"Performance",type:"Individual",price:53.99,billingCycle:"monthly",features:["10 uploads per month","3 monthly credits ($15 value)","All in Core Beta","Core Hub + AI Squash Coach Chat"]},pro:{name:"Pro",type:"Individual",price:83.99,billingCycle:"monthly",features:["25 uploads per month","6 monthly credits ($30 value)","All in Performance"]}};function A(e){let{planId:t,billingCycle:r,price:n,onSuccess:i}=e,l=(0,S.useStripe)(),o=(0,S.useElements)(),[d,p]=(0,s.useState)(!1),[h,f]=(0,s.useState)(null),{toast:x}=j(),y=async e=>{if(e.preventDefault(),l&&o){p(!0),f(null);try{let{error:e,paymentIntent:a}=await l.confirmPayment({elements:o,confirmParams:{return_url:"".concat(window.location.origin,"/payment/success")},redirect:"if_required"});if(e)throw Error(e.message||"An error occurred during payment");if(a&&"succeeded"===a.status)try{let e=await fetch("/api/confirm-subscription",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paymentIntentId:a.id,planId:t,billingCycle:r,price:n})}),s=await e.json();if(!e.ok)throw Error(s.error||"Failed to confirm subscription");i()}catch(e){throw console.error("Error confirming subscription:",e),Error(e.message||"Failed to confirm subscription")}}catch(e){f(e.message||"An error occurred during payment"),x({title:"Payment failed",description:e.message||"There was an error processing your payment. Please try again.",variant:"destructive"})}finally{p(!1)}}};return(0,a.jsxs)("form",{onSubmit:y,children:[(0,a.jsxs)(m.Wu,{className:"space-y-4",children:[h&&(0,a.jsx)("div",{className:"rounded-md bg-destructive/15 px-4 py-3 text-sm text-destructive",children:h}),(0,a.jsx)(S.PaymentElement,{}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 rounded-lg border p-4",children:[(0,a.jsx)(c.A,{className:"h-5 w-5 text-muted-foreground"}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Your payment information is encrypted and secure."})]})]}),(0,a.jsx)(m.wL,{children:(0,a.jsx)(u.$,{className:"w-full",type:"submit",disabled:d||!l||!o,children:d?"Processing...":"Pay $".concat(n)})})]})}function T(){var e,t;let r=(0,n.useRouter)(),i=(0,n.useSearchParams)(),{user:p}=(0,w.A)(),{toast:h}=j(),[f,x]=(0,s.useState)(!1),[y,g]=(0,s.useState)(null),[v,b]=(0,s.useState)(!1),N=i&&null!==(e=i.get("plan"))&&void 0!==e?e:"performance",T="annual"===(i&&null!==(t=i.get("billing"))&&void 0!==t?t:"monthly")?"annual":"monthly",E=k[N],I="annual"===T?(10*E.price).toFixed(2):E.price.toFixed(2);return((0,s.useEffect)(()=>{(async()=>{x(!0);try{if(!i)throw Error("Search params not available");let e=i.get("email");if(!e)throw Error("Email is required");let t=await fetch("/api/create-payment-intent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({planId:N,billingCycle:T,price:I,planName:"".concat(E.name," ").concat(E.type),email:e})});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to create payment intent")}let r=await t.json();g(r.clientSecret)}catch(e){h({title:"Error",description:e.message||"There was an error setting up the payment. Please try again.",variant:"destructive"})}finally{x(!1)}})()},[N,T,I,p,h,E.name,E.type,C]),C)?f?(0,a.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):y?(0,a.jsx)(S.Elements,{stripe:C,options:{clientSecret:y},children:(0,a.jsx)("div",{className:"flex min-h-screen bg-muted/40 py-12",children:(0,a.jsxs)("div",{className:"container max-w-md mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-6",children:[(0,a.jsx)(u.$,{variant:"outline",size:"icon",asChild:!0,children:(0,a.jsxs)(l(),{href:"/memberships",children:[(0,a.jsx)(o.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Back"})]})}),(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Complete Your Subscription"})]}),(0,a.jsxs)(m.Zp,{children:[(0,a.jsx)(m.aR,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(m.ZB,{children:[E.name," Plan"]}),(0,a.jsxs)(m.BT,{children:[E.type," - ",T," billing"]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:["$",I]}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"annual"===T?"per year":"per month"})]})]})}),(0,a.jsx)(m.Wu,{children:(0,a.jsx)(A,{planId:N,billingCycle:T,price:I,onSuccess:()=>{b(!0),h({title:"Payment successful!",description:"Your subscription has been activated."}),r.push("/payment/success")}})})]}),(0,a.jsxs)(m.Zp,{className:"mt-6",children:[(0,a.jsx)(m.aR,{children:(0,a.jsx)(m.ZB,{children:"Plan Features"})}),(0,a.jsx)(m.Wu,{children:(0,a.jsx)("ul",{className:"space-y-2",children:E.features.map((e,t)=>(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[(0,a.jsx)(d.A,{className:"h-4 w-4 text-primary mt-0.5"}),(0,a.jsx)("span",{className:"text-sm",children:e})]},t))})})]}),(0,a.jsxs)("div",{className:"mt-6 text-center text-sm text-muted-foreground",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-2",children:[(0,a.jsx)(c.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Secure payment powered by Stripe"})]}),(0,a.jsxs)("p",{children:["Need help?"," ",(0,a.jsx)(l(),{href:"/contact",className:"text-primary hover:underline",children:"Contact support"})]})]})]})})}):(0,a.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,a.jsx)("div",{children:"Preparing payment form..."})}):(0,a.jsx)("div",{children:"Loading..."})}},7168:(e,t,r)=>{"use strict";r.d(t,{$:()=>o});var a=r(5155),s=r(2115),n=r(9708),i=r(2085),l=r(3999);let c=(0,i.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-white dark:bg-white dark:text-black hover:bg-primary/90 dark:hover:bg-white/90",destructive:"bg-destructive text-white hover:bg-destructive/90 dark:bg-red-600",outline:"border border-primary text-primary dark:border-white dark:text-white bg-transparent hover:bg-primary/10 dark:hover:bg-white/10",secondary:"bg-white text-primary dark:bg-black dark:text-white hover:bg-white/90 dark:hover:bg-black/90",ghost:"text-primary dark:text-white hover:bg-primary/10 dark:hover:bg-white/10",link:"text-primary dark:text-white underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",xl:"h-14 rounded-md px-10",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=s.forwardRef((e,t)=>{let{className:r,variant:s,size:i,asChild:o=!1,...d}=e,u=o?n.DX:"button";return(0,a.jsx)(u,{className:(0,l.cn)(c({variant:s,size:i,className:r})),ref:t,...d})});o.displayName="Button"},8482:(e,t,r)=>{"use strict";r.d(t,{BT:()=>o,Wu:()=>d,ZB:()=>c,Zp:()=>i,aR:()=>l,wL:()=>u});var a=r(5155),s=r(2115),n=r(3999);let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...s})});i.displayName="Card";let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...s})});l.displayName="CardHeader";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",r),...s})});c.displayName="CardTitle";let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...s})});o.displayName="CardDescription";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...s})});d.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...s})});u.displayName="CardFooter"},8915:(e,t,r)=>{"use strict";r.d(t,{$A:()=>d,db:()=>c,j2:()=>l});var a=r(3915),s=r(6203),n=r(5317);let i=0===(0,a.Dk)().length?(0,a.Wp)({apiKey:"AIzaSyCBUHBbrckrtj5zdd2asnCuCVMaq1a8m-c",authDomain:"core-analytics-ai-ff40e.firebaseapp.com",projectId:"core-analytics-ai-ff40e",storageBucket:"core-analytics-ai-ff40e.firebasestorage.app",messagingSenderId:"487617706713",appId:"1:487617706713:web:2e7a41a8723452b139cc8",measurementId:"G-5XDQL0L5C8"}):(0,a.Dk)()[0],l=(0,s.xI)(i),c=(0,n.aU)(i),o=new s.HF;o.addScope("profile"),o.addScope("email"),o.setCustomParameters({prompt:"select_account"}),l.useDeviceLanguage(),l.setPersistence(s.F0);let d={url:"".concat("http://localhost:3000","/auth/verify-email"),handleCodeInApp:!0}}},e=>{var t=t=>e(e.s=t);e.O(0,[2992,6122,4277,6874,5672,1106,8441,1684,7358],()=>t(779)),_N_E=e.O()}]);